{% extends "layout.html" %}
{% block content %}

<h2 class="text-primary mb-4">Prediction Results (Page {{ page }} of {{ total_pages }})</h2>

<table class="table table-bordered table-striped">
    <thead class="table-dark">
        <tr>
            <th>#</th>
            <th>duration</th>
            <th>src_bytes</th>
            <th>dst_bytes</th>
            <th>RF</th>
            <th>LGBM</th>
            <th>SVM</th>
        </tr>
    </thead>

    <tbody>
        {% for i, row in df.iterrows() %}
        <tr 
{% if row.RF_Prediction == 1 
   or row.LightGBM_Prediction == 1 
   or row.SVM_Prediction == 1 %}

   style="background-color:#ffcccc;"

{% endif %}
>

            <td>{{ loop.index + (page-1)*50 }}</td>
            <td>{{ row.duration }}</td>
            <td>{{ row.src_bytes }}</td>
            <td>{{ row.dst_bytes }}</td>
            <td>{{ row.RF_Prediction }}</td>
            <td>{{ row.LightGBM_Prediction }}</td>
            <td>{{ row.SVM_Prediction }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Pagination Controls -->
<div class="d-flex justify-content-center mt-4">

    <!-- Pagination Controls -->
<nav aria-label="Pagination" class="mt-4">
    <ul class="pagination justify-content-center">

        <!-- Previous -->
        {% if page > 1 %}
        <li class="page-item"><a class="page-link" href="/results?page={{ page-1 }}">Previous</a></li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">Previous</span></li>
        {% endif %}

        <!-- Always show first 2 pages -->
        {% for p in [1, 2] %}
            {% if p <= total_pages %}
                {% if p == page %}
                <li class="page-item active"><span class="page-link">{{ p }}</span></li>
                {% else %}
                <li class="page-item"><a class="page-link" href="/results?page={{ p }}">{{ p }}</a></li>
                {% endif %}
            {% endif %}
        {% endfor %}

        <!-- Left dots -->
        {% if page > 4 %}
        <li class="page-item disabled"><span class="page-link">...</span></li>
        {% endif %}

        <!-- Middle pages around current page -->
        {% for p in range(page-2, page+3) %}
            {% if p > 2 and p < total_pages %}
                {% if p == page %}
                <li class="page-item active"><span class="page-link">{{ p }}</span></li>
                {% else %}
                <li class="page-item"><a class="page-link" href="/results?page={{ p }}">{{ p }}</a></li>
                {% endif %}
            {% endif %}
        {% endfor %}

        <!-- Right dots -->
        {% if page < total_pages-3 %}
        <li class="page-item disabled"><span class="page-link">...</span></li>
        {% endif %}

        <!-- Last 2 pages -->
        {% for p in [total_pages-1, total_pages] %}
            {% if p > 2 %}
                {% if p == page %}
                <li class="page-item active"><span class="page-link">{{ p }}</span></li>
                {% else %}
                <li class="page-item"><a class="page-link" href="/results?page={{ p }}">{{ p }}</a></li>
                {% endif %}
            {% endif %}
        {% endfor %}

        <!-- Next -->
        {% if page < total_pages %}
        <li class="page-item"><a class="page-link" href="/results?page={{ page+1 }}">Next</a></li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">Next</span></li>
        {% endif %}

    </ul>
</nav>

</div>


{% endblock %}
